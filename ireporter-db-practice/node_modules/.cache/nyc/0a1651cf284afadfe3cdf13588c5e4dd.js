'use strict';var cov_2pkuyvwq48=function(){var path="/home/enejakc/Documents/projects/ireporter-db-practice/server/middleware/inspector.js",hash="a848dffff9118ce00765d2fec202132187f14e81",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/enejakc/Documents/projects/ireporter-db-practice/server/middleware/inspector.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:7,column:17},end:{line:7,column:51}},"2":{start:{line:9,column:18},end:{line:9,column:52}},"3":{start:{line:11,column:14},end:{line:11,column:37}},"4":{start:{line:13,column:15},end:{line:13,column:46}},"5":{start:{line:15,column:14},end:{line:15,column:31}},"6":{start:{line:17,column:15},end:{line:17,column:46}},"7":{start:{line:19,column:39},end:{line:19,column:93}},"8":{start:{line:21,column:33},end:{line:21,column:456}},"9":{start:{line:21,column:64},end:{line:21,column:89}},"10":{start:{line:21,column:91},end:{line:21,column:453}},"11":{start:{line:21,column:165},end:{line:21,column:263}},"12":{start:{line:21,column:182},end:{line:21,column:195}},"13":{start:{line:21,column:209},end:{line:21,column:219}},"14":{start:{line:21,column:239},end:{line:21,column:253}},"15":{start:{line:21,column:254},end:{line:21,column:261}},"16":{start:{line:21,column:264},end:{line:21,column:426}},"17":{start:{line:21,column:281},end:{line:21,column:296}},"18":{start:{line:21,column:306},end:{line:21,column:424}},"19":{start:{line:21,column:360},end:{line:21,column:380}},"20":{start:{line:21,column:401},end:{line:21,column:420}},"21":{start:{line:21,column:429},end:{line:21,column:449}},"22":{start:{line:25,column:4},end:{line:88,column:9}},"23":{start:{line:26,column:26},end:{line:28,column:7}},"24":{start:{line:27,column:8},end:{line:27,column:69}},"25":{start:{line:39,column:10},end:{line:39,column:18}},"26":{start:{line:41,column:29},end:{line:41,column:97}},"27":{start:{line:42,column:28},end:{line:54,column:19}},"28":{start:{line:43,column:21},end:{line:50,column:9}},"29":{start:{line:51,column:8},end:{line:51,column:72}},"30":{start:{line:53,column:8},end:{line:53,column:30}},"31":{start:{line:56,column:6},end:{line:58,column:7}},"32":{start:{line:57,column:8},end:{line:57,column:93}},"33":{start:{line:60,column:6},end:{line:60,column:142}},"34":{start:{line:60,column:55},end:{line:60,column:142}},"35":{start:{line:61,column:6},end:{line:61,column:139}},"36":{start:{line:61,column:54},end:{line:61,column:139}},"37":{start:{line:62,column:6},end:{line:64,column:7}},"38":{start:{line:63,column:8},end:{line:63,column:83}},"39":{start:{line:65,column:6},end:{line:65,column:132}},"40":{start:{line:65,column:79},end:{line:65,column:132}},"41":{start:{line:66,column:6},end:{line:66,column:185}},"42":{start:{line:66,column:64},end:{line:66,column:185}},"43":{start:{line:67,column:6},end:{line:67,column:147}},"44":{start:{line:67,column:60},end:{line:67,column:147}},"45":{start:{line:69,column:6},end:{line:75,column:7}},"46":{start:{line:70,column:27},end:{line:70,column:113}},"47":{start:{line:71,column:8},end:{line:71,column:99}},"48":{start:{line:71,column:24},end:{line:71,column:99}},"49":{start:{line:73,column:8},end:{line:73,column:27}},"50":{start:{line:74,column:8},end:{line:74,column:39}},"51":{start:{line:76,column:6},end:{line:76,column:50}},"52":{start:{line:77,column:6},end:{line:77,column:48}},"53":{start:{line:78,column:6},end:{line:78,column:42}},"54":{start:{line:79,column:6},end:{line:79,column:38}},"55":{start:{line:80,column:6},end:{line:80,column:54}},"56":{start:{line:81,column:6},end:{line:81,column:42}},"57":{start:{line:82,column:6},end:{line:82,column:48}},"58":{start:{line:83,column:6},end:{line:83,column:52}},"59":{start:{line:84,column:6},end:{line:84,column:57}},"60":{start:{line:85,column:6},end:{line:85,column:54}},"61":{start:{line:87,column:6},end:{line:87,column:20}},"62":{start:{line:92,column:0},end:{line:92,column:26}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:19,column:9},end:{line:19,column:31}},loc:{start:{line:19,column:37},end:{line:19,column:95}},line:19},"1":{name:"_asyncToGenerator",decl:{start:{line:21,column:9},end:{line:21,column:26}},loc:{start:{line:21,column:31},end:{line:21,column:458}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:40},end:{line:21,column:41}},loc:{start:{line:21,column:52},end:{line:21,column:455}},line:21},"3":{name:"(anonymous_3)",decl:{start:{line:21,column:110},end:{line:21,column:111}},loc:{start:{line:21,column:137},end:{line:21,column:451}},line:21},"4":{name:"step",decl:{start:{line:21,column:148},end:{line:21,column:152}},loc:{start:{line:21,column:163},end:{line:21,column:428}},line:21},"5":{name:"(anonymous_5)",decl:{start:{line:21,column:341},end:{line:21,column:342}},loc:{start:{line:21,column:358},end:{line:21,column:382}},line:21},"6":{name:"(anonymous_6)",decl:{start:{line:21,column:384},end:{line:21,column:385}},loc:{start:{line:21,column:399},end:{line:21,column:422}},line:21},"7":{name:"(anonymous_7)",decl:{start:{line:24,column:2},end:{line:24,column:3}},loc:{start:{line:24,column:32},end:{line:89,column:3}},line:24},"8":{name:"(anonymous_8)",decl:{start:{line:25,column:29},end:{line:25,column:30}},loc:{start:{line:25,column:42},end:{line:88,column:5}},line:25},"9":{name:"(anonymous_9)",decl:{start:{line:26,column:26},end:{line:26,column:27}},loc:{start:{line:26,column:45},end:{line:28,column:7}},line:26},"10":{name:"(anonymous_10)",decl:{start:{line:42,column:47},end:{line:42,column:48}},loc:{start:{line:42,column:71},end:{line:52,column:7}},line:42},"11":{name:"(anonymous_11)",decl:{start:{line:52,column:16},end:{line:52,column:17}},loc:{start:{line:52,column:33},end:{line:54,column:7}},line:52}},branchMap:{"0":{loc:{start:{line:19,column:46},end:{line:19,column:92}},type:"cond-expr",locations:[{start:{line:19,column:70},end:{line:19,column:73}},{start:{line:19,column:76},end:{line:19,column:92}}],line:19},"1":{loc:{start:{line:19,column:46},end:{line:19,column:67}},type:"binary-expr",locations:[{start:{line:19,column:46},end:{line:19,column:49}},{start:{line:19,column:53},end:{line:19,column:67}}],line:19},"2":{loc:{start:{line:21,column:264},end:{line:21,column:426}},type:"if",locations:[{start:{line:21,column:264},end:{line:21,column:426}},{start:{line:21,column:264},end:{line:21,column:426}}],line:21},"3":{loc:{start:{line:51,column:15},end:{line:51,column:71}},type:"cond-expr",locations:[{start:{line:51,column:53},end:{line:51,column:64}},{start:{line:51,column:67},end:{line:51,column:71}}],line:51},"4":{loc:{start:{line:51,column:15},end:{line:51,column:50}},type:"binary-expr",locations:[{start:{line:51,column:15},end:{line:51,column:34}},{start:{line:51,column:38},end:{line:51,column:50}}],line:51},"5":{loc:{start:{line:56,column:6},end:{line:58,column:7}},type:"if",locations:[{start:{line:56,column:6},end:{line:58,column:7}},{start:{line:56,column:6},end:{line:58,column:7}}],line:56},"6":{loc:{start:{line:56,column:10},end:{line:56,column:92}},type:"binary-expr",locations:[{start:{line:56,column:10},end:{line:56,column:20}},{start:{line:56,column:24},end:{line:56,column:33}},{start:{line:56,column:37},end:{line:56,column:49}},{start:{line:56,column:53},end:{line:56,column:59}},{start:{line:56,column:63},end:{line:56,column:72}},{start:{line:56,column:76},end:{line:56,column:92}}],line:56},"7":{loc:{start:{line:60,column:6},end:{line:60,column:142}},type:"if",locations:[{start:{line:60,column:6},end:{line:60,column:142}},{start:{line:60,column:6},end:{line:60,column:142}}],line:60},"8":{loc:{start:{line:61,column:6},end:{line:61,column:139}},type:"if",locations:[{start:{line:61,column:6},end:{line:61,column:139}},{start:{line:61,column:6},end:{line:61,column:139}}],line:61},"9":{loc:{start:{line:62,column:6},end:{line:64,column:7}},type:"if",locations:[{start:{line:62,column:6},end:{line:64,column:7}},{start:{line:62,column:6},end:{line:64,column:7}}],line:62},"10":{loc:{start:{line:65,column:6},end:{line:65,column:132}},type:"if",locations:[{start:{line:65,column:6},end:{line:65,column:132}},{start:{line:65,column:6},end:{line:65,column:132}}],line:65},"11":{loc:{start:{line:66,column:6},end:{line:66,column:185}},type:"if",locations:[{start:{line:66,column:6},end:{line:66,column:185}},{start:{line:66,column:6},end:{line:66,column:185}}],line:66},"12":{loc:{start:{line:67,column:6},end:{line:67,column:147}},type:"if",locations:[{start:{line:67,column:6},end:{line:67,column:147}},{start:{line:67,column:6},end:{line:67,column:147}}],line:67},"13":{loc:{start:{line:71,column:8},end:{line:71,column:99}},type:"if",locations:[{start:{line:71,column:8},end:{line:71,column:99}},{start:{line:71,column:8},end:{line:71,column:99}}],line:71},"14":{loc:{start:{line:78,column:23},end:{line:78,column:41}},type:"binary-expr",locations:[{start:{line:78,column:23},end:{line:78,column:33}},{start:{line:78,column:37},end:{line:78,column:41}}],line:78},"15":{loc:{start:{line:79,column:21},end:{line:79,column:37}},type:"binary-expr",locations:[{start:{line:79,column:21},end:{line:79,column:29}},{start:{line:79,column:33},end:{line:79,column:37}}],line:79},"16":{loc:{start:{line:83,column:20},end:{line:83,column:51}},type:"cond-expr",locations:[{start:{line:83,column:31},end:{line:83,column:44}},{start:{line:83,column:47},end:{line:83,column:51}}],line:83}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0,0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_2pkuyvwq48.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var _validator=(cov_2pkuyvwq48.s[1]++,require('../validators/validator'));var _validator2=(cov_2pkuyvwq48.s[2]++,_interopRequireDefault(_validator));var _config=(cov_2pkuyvwq48.s[3]++,require('../db/config'));var _config2=(cov_2pkuyvwq48.s[4]++,_interopRequireDefault(_config));var _moment=(cov_2pkuyvwq48.s[5]++,require('moment'));var _moment2=(cov_2pkuyvwq48.s[6]++,_interopRequireDefault(_moment));function _interopRequireDefault(obj){cov_2pkuyvwq48.f[0]++;cov_2pkuyvwq48.s[7]++;return(cov_2pkuyvwq48.b[1][0]++,obj)&&(cov_2pkuyvwq48.b[1][1]++,obj.__esModule)?(cov_2pkuyvwq48.b[0][0]++,obj):(cov_2pkuyvwq48.b[0][1]++,{default:obj});}function _asyncToGenerator(fn){cov_2pkuyvwq48.f[1]++;cov_2pkuyvwq48.s[8]++;return function(){cov_2pkuyvwq48.f[2]++;var gen=(cov_2pkuyvwq48.s[9]++,fn.apply(this,arguments));cov_2pkuyvwq48.s[10]++;return new Promise(function(resolve,reject){cov_2pkuyvwq48.f[3]++;function step(key,arg){cov_2pkuyvwq48.f[4]++;cov_2pkuyvwq48.s[11]++;try{var info=(cov_2pkuyvwq48.s[12]++,gen[key](arg));var value=(cov_2pkuyvwq48.s[13]++,info.value);}catch(error){cov_2pkuyvwq48.s[14]++;reject(error);cov_2pkuyvwq48.s[15]++;return;}cov_2pkuyvwq48.s[16]++;if(info.done){cov_2pkuyvwq48.b[2][0]++;cov_2pkuyvwq48.s[17]++;resolve(value);}else{cov_2pkuyvwq48.b[2][1]++;cov_2pkuyvwq48.s[18]++;return Promise.resolve(value).then(function(value){cov_2pkuyvwq48.f[5]++;cov_2pkuyvwq48.s[19]++;step("next",value);},function(err){cov_2pkuyvwq48.f[6]++;cov_2pkuyvwq48.s[20]++;step("throw",err);});}}cov_2pkuyvwq48.s[21]++;return step("next");});};}class Inspect{static signup(req,res,next){cov_2pkuyvwq48.f[7]++;cov_2pkuyvwq48.s[22]++;return _asyncToGenerator(function*(){cov_2pkuyvwq48.f[8]++;cov_2pkuyvwq48.s[23]++;const response400=function(message){cov_2pkuyvwq48.f[9]++;cov_2pkuyvwq48.s[24]++;return res.status(400).json({status:400,error:message});};const{firstname,lastname,othernames,username,phoneNumber,email,password,confirmPassword,adminSecret}=(cov_2pkuyvwq48.s[25]++,req.body);const requiredFields=(cov_2pkuyvwq48.s[26]++,[firstname,lastname,phoneNumber,email,password,confirmPassword]);const missingFields=(cov_2pkuyvwq48.s[27]++,requiredFields.map(function(field,index){cov_2pkuyvwq48.f[10]++;const keys=(cov_2pkuyvwq48.s[28]++,{0:'firstname',1:'lastname',2:'phoneNumber',3:'email',4:'password',5:'confirmPassword'});cov_2pkuyvwq48.s[29]++;return(cov_2pkuyvwq48.b[4][0]++,field===undefined)||(cov_2pkuyvwq48.b[4][1]++,field==='')?(cov_2pkuyvwq48.b[3][0]++,keys[index]):(cov_2pkuyvwq48.b[3][1]++,null);}).filter(function(field){cov_2pkuyvwq48.f[11]++;cov_2pkuyvwq48.s[30]++;return field!==null;}).join(', '));cov_2pkuyvwq48.s[31]++;if((cov_2pkuyvwq48.b[6][0]++,!firstname)||(cov_2pkuyvwq48.b[6][1]++,!lastname)||(cov_2pkuyvwq48.b[6][2]++,!phoneNumber)||(cov_2pkuyvwq48.b[6][3]++,!email)||(cov_2pkuyvwq48.b[6][4]++,!password)||(cov_2pkuyvwq48.b[6][5]++,!confirmPassword)){cov_2pkuyvwq48.b[5][0]++;cov_2pkuyvwq48.s[32]++;return response400(`values are required for the following fields: ${missingFields}`);}else{cov_2pkuyvwq48.b[5][1]++;}cov_2pkuyvwq48.s[33]++;if(!_validator2.default.isValidName(firstname)){cov_2pkuyvwq48.b[7][0]++;cov_2pkuyvwq48.s[34]++;return response400('invalid first name. First name must be a minimum of 2 characters');}else{cov_2pkuyvwq48.b[7][1]++;}cov_2pkuyvwq48.s[35]++;if(!_validator2.default.isValidName(lastname)){cov_2pkuyvwq48.b[8][0]++;cov_2pkuyvwq48.s[36]++;return response400('invalid last name. Last name must be a minimum of 2 characters');}else{cov_2pkuyvwq48.b[8][1]++;}cov_2pkuyvwq48.s[37]++;if(_validator2.default.customValidateEmail(email).error){cov_2pkuyvwq48.b[9][0]++;cov_2pkuyvwq48.s[38]++;return response400(_validator2.default.customValidateEmail(email).message);}else{cov_2pkuyvwq48.b[9][1]++;}cov_2pkuyvwq48.s[39]++;if(!_validator2.default.isMatchingPasswords(password,confirmPassword)){cov_2pkuyvwq48.b[10][0]++;cov_2pkuyvwq48.s[40]++;return response400('the two passwords do not match');}else{cov_2pkuyvwq48.b[10][1]++;}cov_2pkuyvwq48.s[41]++;if(!_validator2.default.isValidPhoneNumber(phoneNumber)){cov_2pkuyvwq48.b[11][0]++;cov_2pkuyvwq48.s[42]++;return response400('Invalid phone number. Phone number cannot contain characters, and must be less than 16 digits long');}else{cov_2pkuyvwq48.b[11][1]++;}cov_2pkuyvwq48.s[43]++;if(_validator2.default.isPasswordTooShort(password)){cov_2pkuyvwq48.b[12][0]++;cov_2pkuyvwq48.s[44]++;return response400('Invalid password. Password should have a minimum of 6 characters');}else{cov_2pkuyvwq48.b[12][1]++;}cov_2pkuyvwq48.s[45]++;try{const userExists=(cov_2pkuyvwq48.s[46]++,(yield _config2.default.query('SELECT * FROM users WHERE email=$1',[email])).rowCount);cov_2pkuyvwq48.s[47]++;if(userExists){cov_2pkuyvwq48.b[13][0]++;cov_2pkuyvwq48.s[48]++;return response400(`${email} has been taken. Please choose another email`);}else{cov_2pkuyvwq48.b[13][1]++;}}catch(error){cov_2pkuyvwq48.s[49]++;console.log(error);cov_2pkuyvwq48.s[50]++;return response400(`${error}`);// keep an eye on this line
}cov_2pkuyvwq48.s[51]++;req.firstname=firstname.toString().trim();cov_2pkuyvwq48.s[52]++;req.lastname=lastname.toString().trim();cov_2pkuyvwq48.s[53]++;req.othernames=(cov_2pkuyvwq48.b[14][0]++,othernames)||(cov_2pkuyvwq48.b[14][1]++,null);cov_2pkuyvwq48.s[54]++;req.username=(cov_2pkuyvwq48.b[15][0]++,username)||(cov_2pkuyvwq48.b[15][1]++,null);cov_2pkuyvwq48.s[55]++;req.phoneNumber=phoneNumber.toString().trim();cov_2pkuyvwq48.s[56]++;req.email=email.toString().trim();cov_2pkuyvwq48.s[57]++;req.password=password.toString().trim();cov_2pkuyvwq48.s[58]++;req.picture=req.file?(cov_2pkuyvwq48.b[16][0]++,req.file.path):(cov_2pkuyvwq48.b[16][1]++,null);cov_2pkuyvwq48.s[59]++;req.registered=(0,_moment2.default)(new Date());cov_2pkuyvwq48.s[60]++;req.adminSecret=adminSecret.toString().trim();cov_2pkuyvwq48.s[61]++;return next();})();}// END signup
}// END Inspect
cov_2pkuyvwq48.s[62]++;exports.default=Inspect;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluc3BlY3Rvci5qcyJdLCJuYW1lcyI6WyJJbnNwZWN0Iiwic2lnbnVwIiwicmVxIiwicmVzIiwibmV4dCIsInJlc3BvbnNlNDAwIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwibWVzc2FnZSIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwib3RoZXJuYW1lcyIsInVzZXJuYW1lIiwicGhvbmVOdW1iZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwiY29uZmlybVBhc3N3b3JkIiwiYWRtaW5TZWNyZXQiLCJib2R5IiwicmVxdWlyZWRGaWVsZHMiLCJtaXNzaW5nRmllbGRzIiwibWFwIiwiZmllbGQiLCJpbmRleCIsImtleXMiLCJ1bmRlZmluZWQiLCJmaWx0ZXIiLCJqb2luIiwiVmFsaWRhdG9yIiwiaXNWYWxpZE5hbWUiLCJjdXN0b21WYWxpZGF0ZUVtYWlsIiwiaXNNYXRjaGluZ1Bhc3N3b3JkcyIsImlzVmFsaWRQaG9uZU51bWJlciIsImlzUGFzc3dvcmRUb29TaG9ydCIsInVzZXJFeGlzdHMiLCJwb29sIiwicXVlcnkiLCJyb3dDb3VudCIsImNvbnNvbGUiLCJsb2ciLCJ0b1N0cmluZyIsInRyaW0iLCJwaWN0dXJlIiwiZmlsZSIsInBhdGgiLCJyZWdpc3RlcmVkIiwiRGF0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztBQUVBLE1BQU1BLE9BQU4sQ0FBYztBQUNaLFNBQWFDLE1BQWIsQ0FBb0JDLEdBQXBCLEVBQXlCQyxHQUF6QixFQUE4QkMsSUFBOUIsRUFBb0M7QUFBQTtBQUNsQyxZQUFNQyxjQUFjO0FBQUEsZUFBV0YsSUFBSUcsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLEVBQUVELFFBQVEsR0FBVixFQUFlRSxPQUFPQyxPQUF0QixFQUFyQixDQUFYO0FBQUEsT0FBcEI7QUFDQSxZQUFNO0FBQ0pDLGlCQURJO0FBRUpDLGdCQUZJO0FBR0pDLGtCQUhJO0FBSUpDLGdCQUpJO0FBS0pDLG1CQUxJ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b0JDLElBQXBCLEVBQWY7QUFDQXhDLFVBQUl5QyxPQUFKLEdBQWN6QyxJQUFJMEMsSUFBSixHQUFXMUMsSUFBSTBDLElBQUosQ0FBU0MsSUFBcEIsR0FBMkIsSUFBekM7QUFDQTNDLFVBQUk0QyxVQUFKLEdBQWlCLHNCQUFPLElBQUlDLElBQUosRUFBUCxDQUFqQjtBQUNBN0MsVUFBSWdCLFdBQUosR0FBa0JBLFlBQVl1QixRQUFaLEdBQXVCQyxJQUF2QixFQUFsQjs7QUFFQSxhQUFPdEMsTUFBUDtBQTFEa0M7QUEyRG5DLEdBNURXLENBNERWO0FBNURVLEMsQ0E2RFo7O2tCQUVhSixPIiwiZmlsZSI6Imluc3BlY3Rvci5qcyIsInNvdXJjZVJvb3QiOiIvaG9tZS9lbmVqYWtjL0RvY3VtZW50cy9wcm9qZWN0cy9pcmVwb3J0ZXItZGItcHJhY3RpY2Uvc2VydmVyL21pZGRsZXdhcmUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVmFsaWRhdG9yIGZyb20gJy4uL3ZhbGlkYXRvcnMvdmFsaWRhdG9yJztcbmltcG9ydCBwb29sIGZyb20gJy4uL2RiL2NvbmZpZyc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5cbmNsYXNzIEluc3BlY3Qge1xuICBzdGF0aWMgYXN5bmMgc2lnbnVwKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgY29uc3QgcmVzcG9uc2U0MDAgPSBtZXNzYWdlID0+IHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgc3RhdHVzOiA0MDAsIGVycm9yOiBtZXNzYWdlIH0pO1xuICAgIGNvbnN0IHtcbiAgICAgIGZpcnN0bmFtZSxcbiAgICAgIGxhc3RuYW1lLFxuICAgICAgb3RoZXJuYW1lcyxcbiAgICAgIHVzZXJuYW1lLFxuICAgICAgcGhvbmVOdW1iZXIsXG4gICAgICBlbWFpbCxcbiAgICAgIHBhc3N3b3JkLFxuICAgICAgY29uZmlybVBhc3N3b3JkLFxuICAgICAgYWRtaW5TZWNyZXQsXG4gICAgfSA9IHJlcS5ib2R5O1xuXG4gICAgY29uc3QgcmVxdWlyZWRGaWVsZHMgPSBbZmlyc3RuYW1lLCBsYXN0bmFtZSwgcGhvbmVOdW1iZXIsIGVtYWlsLCBwYXNzd29yZCwgY29uZmlybVBhc3N3b3JkXTtcbiAgICBjb25zdCBtaXNzaW5nRmllbGRzID0gcmVxdWlyZWRGaWVsZHMubWFwKChmaWVsZCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IGtleXMgPSB7XG4gICAgICAgIDA6ICdmaXJzdG5hbWUnLFxuICAgICAgICAxOiAnbGFzdG5hbWUnLFxuICAgICAgICAyOiAncGhvbmVOdW1iZXInLFxuICAgICAgICAzOiAnZW1haWwnLFxuICAgICAgICA0OiAncGFzc3dvcmQnLFxuICAgICAgICA1OiAnY29uZmlybVBhc3N3b3JkJyxcbiAgICAgIH07XG4gICAgICByZXR1cm4gKGZpZWxkID09PSB1bmRlZmluZWQgfHwgZmllbGQgPT09ICcnKSA/IGtleXNbaW5kZXhdIDogbnVsbDtcbiAgICB9KS5maWx0ZXIoZmllbGQgPT4gZmllbGQgIT09IG51bGwpLmpvaW4oJywgJyk7XG5cbiAgICBpZiAoIWZpcnN0bmFtZSB8fCAhbGFzdG5hbWUgfHwgIXBob25lTnVtYmVyIHx8ICFlbWFpbCB8fCAhcGFzc3dvcmQgfHwgIWNvbmZpcm1QYXNzd29yZCkge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlNDAwKGB2YWx1ZXMgYXJlIHJlcXVpcmVkIGZvciB0aGUgZm9sbG93aW5nIGZpZWxkczogJHttaXNzaW5nRmllbGRzfWApO1xuICAgIH1cblxuICAgIGlmICghVmFsaWRhdG9yLmlzVmFsaWROYW1lKGZpcnN0bmFtZSkpIHJldHVybiByZXNwb25zZTQwMCgnaW52YWxpZCBmaXJzdCBuYW1lLiBGaXJzdCBuYW1lIG11c3QgYmUgYSBtaW5pbXVtIG9mIDIgY2hhcmFjdGVycycpO1xuICAgIGlmICghVmFsaWRhdG9yLmlzVmFsaWROYW1lKGxhc3RuYW1lKSkgcmV0dXJuIHJlc3BvbnNlNDAwKCdpbnZhbGlkIGxhc3QgbmFtZS4gTGFzdCBuYW1lIG11c3QgYmUgYSBtaW5pbXVtIG9mIDIgY2hhcmFjdGVycycpO1xuICAgIGlmIChWYWxpZGF0b3IuY3VzdG9tVmFsaWRhdGVFbWFpbChlbWFpbCkuZXJyb3IpIHtcbiAgICAgIHJldHVybiByZXNwb25zZTQwMChWYWxpZGF0b3IuY3VzdG9tVmFsaWRhdGVFbWFpbChlbWFpbCkubWVzc2FnZSk7XG4gICAgfVxuICAgIGlmICghVmFsaWRhdG9yLmlzTWF0Y2hpbmdQYXNzd29yZHMocGFzc3dvcmQsIGNvbmZpcm1QYXNzd29yZCkpIHJldHVybiByZXNwb25zZTQwMCgndGhlIHR3byBwYXNzd29yZHMgZG8gbm90IG1hdGNoJyk7XG4gICAgaWYgKCFWYWxpZGF0b3IuaXNWYWxpZFBob25lTnVtYmVyKHBob25lTnVtYmVyKSkgcmV0dXJuIHJlc3BvbnNlNDAwKCdJbnZhbGlkIHBob25lIG51bWJlci4gUGhvbmUgbnVtYmVyIGNhbm5vdCBjb250YWluIGNoYXJhY3RlcnMsIGFuZCBtdXN0IGJlIGxlc3MgdGhhbiAxNiBkaWdpdHMgbG9uZycpO1xuICAgIGlmIChWYWxpZGF0b3IuaXNQYXNzd29yZFRvb1Nob3J0KHBhc3N3b3JkKSkgcmV0dXJuIHJlc3BvbnNlNDAwKCdJbnZhbGlkIHBhc3N3b3JkLiBQYXNzd29yZCBzaG91bGQgaGF2ZSBhIG1pbmltdW0gb2YgNiBjaGFyYWN0ZXJzJyk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlckV4aXN0cyA9IChhd2FpdCBwb29sLnF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsPSQxJywgW2VtYWlsXSkpLnJvd0NvdW50O1xuICAgICAgaWYodXNlckV4aXN0cykgcmV0dXJuIHJlc3BvbnNlNDAwKGAke2VtYWlsfSBoYXMgYmVlbiB0YWtlbi4gUGxlYXNlIGNob29zZSBhbm90aGVyIGVtYWlsYCk7XG4gICAgfSBjYXRjaChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlNDAwKGAke2Vycm9yfWApOyAvLyBrZWVwIGFuIGV5ZSBvbiB0aGlzIGxpbmVcbiAgICB9XG4gICAgcmVxLmZpcnN0bmFtZSA9IGZpcnN0bmFtZS50b1N0cmluZygpLnRyaW0oKTtcbiAgICByZXEubGFzdG5hbWUgPSBsYXN0bmFtZS50b1N0cmluZygpLnRyaW0oKTtcbiAgICByZXEub3RoZXJuYW1lcyA9IG90aGVybmFtZXMgfHwgbnVsbDtcbiAgICByZXEudXNlcm5hbWUgPSB1c2VybmFtZSB8fCBudWxsO1xuICAgIHJlcS5waG9uZU51bWJlciA9IHBob25lTnVtYmVyLnRvU3RyaW5nKCkudHJpbSgpO1xuICAgIHJlcS5lbWFpbCA9IGVtYWlsLnRvU3RyaW5nKCkudHJpbSgpO1xuICAgIHJlcS5wYXNzd29yZCA9IHBhc3N3b3JkLnRvU3RyaW5nKCkudHJpbSgpO1xuICAgIHJlcS5waWN0dXJlID0gcmVxLmZpbGUgPyByZXEuZmlsZS5wYXRoIDogbnVsbDtcbiAgICByZXEucmVnaXN0ZXJlZCA9IG1vbWVudChuZXcgRGF0ZSgpKTtcbiAgICByZXEuYWRtaW5TZWNyZXQgPSBhZG1pblNlY3JldC50b1N0cmluZygpLnRyaW0oKTtcblxuICAgIHJldHVybiBuZXh0KCk7XG4gIH0gLy8gRU5EIHNpZ251cFxufSAvLyBFTkQgSW5zcGVjdFxuXG5leHBvcnQgZGVmYXVsdCBJbnNwZWN0O1xuIl19
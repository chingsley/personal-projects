{"version":3,"sources":["seed.js"],"names":["users","admin","id","firstname","lastname","phoneNumber","email","password","confirmPassword","adminSecret","validUserOne","validUserTwo","validUserInvalidPass","invalidUser","invalidUserNoData","invalidUserNoFirstname","invalidUserNoEmail","invalidUserNoPass","invalidUserMissmatchedPassword","incorrectFirstname","incorrectLastname","incorrectEmail","passwordTooShort","generateValidToken","userObject","jwt","sign","userId","userName","userEmail","userStatus","process","env","ADMIN_SECRET","JWT_SECRET","toString","dropAndRecreateTables","dropUsersTableQuery","dropIncidentsTableQuery","createUsersTableQuery","createIncidentsTableQuery","pool","query","populateIncidents","dbQuery"],"mappings":"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","file":"seed.js","sourceRoot":"/home/enejakc/Documents/projects/ireporter-db-practice/tests/seed","sourcesContent":["import jwt from 'jsonwebtoken';\nimport pool from '../../server/db/config';\n\nconst users = {\n    admin: {\n        id: 1,\n        firstname: 'kingsley',\n        lastname: 'eneja',\n        phoneNumber: '09063550695',\n        email: 'eneja.kc@gmail.com',\n        password: 'kingsley',\n        confirmPassword: 'kingsley',\n        adminSecret: 'nimdamai',\n    },\n    validUserOne: {\n        id: 2,\n        firstname: 'john',\n        lastname: 'snow',\n        phoneNumber: '08023875011',\n        email: 'johnsnow@gmail.com',\n        password: 'john',\n        confirmPassword: 'john',\n        adminSecret: '',\n    },\n    validUserTwo: {\n        id: 3,\n        firstname: 'theon',\n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'theongreyjoy@gmail.com',\n        password: 'theon',\n        confirmPassword: 'theon',\n        adminSecret: '',\n    },\n    validUserInvalidPass: {\n        email: 'johnsnow@gmail.com',\n        password: 'wrongpassword',\n    },\n    invalidUser: {\n        firstname: 'four-O-four',\n        // email: 'no@email.address',\n        email: 'aturoVidal@gmail.com',\n        password: 'invalid',\n    },\n    invalidUserNoData: {},\n    invalidUserNoFirstname: {\n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'theongreyjoy@gmail.com',\n        password: 'theon',\n        confirmPassword: 'theon',\n    },\n    invalidUserNoEmail: {\n        firstname: 'theon',\n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        password: 'theon',\n        confirmPassword: 'theon',\n        adminSecret: '',\n    },\n    invalidUserNoPass: {\n        firstname: 'theon',\n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'theongreyjoy@gmail.com',\n        adminSecret: '',\n    },\n    invalidUserMissmatchedPassword: {\n        firstname: 'theon',\n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'theongreyjoy@gmail.com',\n        password: 'theon',\n        confirmPassword: 'nottheon',\n        adminSecret: '',\n    },\n    incorrectFirstname: {\n        firstname: 't', // firstname less than 2 characters\n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'theongreyjoy@gmail.com',\n        password: 'theon',\n        confirmPassword: 'theon',\n        adminSecret: ''\n    },\n    incorrectLastname: {\n        firstname: 'theon', \n        lastname: 'g', // lastname less than 2 characters\n        phoneNumber: '0808822928',\n        email: 'theongreyjoy@gmail.com',\n        password: 'theon',\n        confirmPassword: 'theon',\n        adminSecret: ''\n    },\n    incorrectEmail: {\n        firstname: 'theon', \n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'kc@-gmail.com ', // email: leading dash in front of domain is not allowed\n        password: 'theon',\n        confirmPassword: 'theon',\n        adminSecret: ''\n    },\n    passwordTooShort: {\n        firstname: 'theon', \n        lastname: 'greyjoy',\n        phoneNumber: '0808822928',\n        email: 'eneja.kc@gmail.com ', // email: leading dash in front of domain is not allowed\n        password: 'theo',\n        confirmPassword: 'theo',\n        adminSecret: ''\n    },\n};\n\n/**\n * @function generateValidToken - generates a valid JWT based on the user details object passed in\n * @param {Object} userObject - the details of the user\n * @returns {String} - a valid, signed, JSON Web Token\n *\n */\nfunction generateValidToken(userObject) {\n    return jwt.sign({\n        userId: userObject.id,\n        userName: userObject.firstname,\n        userEmail: userObject.email,\n        userStatus: userObject.adminSecret === process.env.ADMIN_SECRET ? 'admin' : 'customer',\n    }, process.env.JWT_SECRET).toString();\n}\n\n/**\n * @async\n * @function dropAndRecreateTables - purges the database data\n */\nconst dropAndRecreateTables = async () => {\n    const dropUsersTableQuery = 'DROP TABLE IF EXISTS users CASCADE';\n    const dropIncidentsTableQuery = 'DROP TABLE IF EXISTS incidents CASCADE';\n\n    const createUsersTableQuery = `CREATE TABLE IF NOT EXISTS\n        users(\n            id serial PRIMARY KEY,\n            firstname VARCHAR(50) NOT NULL,\n            lastname VARCHAR(50) NOT NULL,\n            othernames VARCHAR(50) DEFAULT NULL,\n            username VARCHAR(50) NOT NULL,\n            phonenumber VARCHAR(50) NOT NULL,\n            email VARCHAR(128) UNIQUE NOT NULL,\n            password VARCHAR(128) NOT NULL,\n            picture TEXT DEFAULT NULL,\n            registered TIMESTAMP,\n            is_admin BOOLEAN NOT NULL\n\n        )`;\n\n    const createIncidentsTableQuery = `CREATE TABLE IF NOT EXISTS\n        incidents(\n            id serial PRIMARY KEY,\n            created_on TIMESTAMP,\n            created_by serial NOT NULL,\n            type TEXT NOT NULL,\n            location TEXT NOT NULL,\n            status VARCHAR(50) NOT NULL DEFAULT 'draft',\n            images TEXT DEFAULT NULL,\n            videos TEXT DEFAULT NULL,\n            comment TEXT NOT NULL,\n            FOREIGN KEY (created_by) REFERENCES users (id) ON DELETE CASCADE\n        )`;\n\n    await pool.query(dropUsersTableQuery);\n    await pool.query(dropIncidentsTableQuery);\n    await pool.query(createUsersTableQuery);\n    await pool.query(createIncidentsTableQuery);\n};\n\n/**\n * @async\n * @function populateMenu - adds two food items to the database\n */\nconst populateIncidents = async () => {\n    const dbQuery = `INSERT INTO incidents(created_by, type, location, status, comment)\n    VALUES\n    (1, 'red-flag', '2.989887, 9.7979799', 'draft', 'just testing the system'),\n    (2, 'intervention', '2.55566, 6.55654', 'draft', 'another testing performed');`; \n    await pool.query(dbQuery);\n};\n\nexport {\n    users,\n    dropAndRecreateTables,\n    populateIncidents,\n    generateValidToken,\n};\n"]}
{"version":3,"sources":["inspector.js"],"names":["Inspect","signup","req","res","next","response400","message","status","json","error","firstname","lastname","othernames","username","phoneNumber","email","password","confirmPassword","picture","adminSecret","body","requiredFields","missingFields","map","field","index","keys","undefined","filter","join","Validator","isValidName","customValidateEmail","isMatchingPasswords","isPasswordTooShort","toString","trim","file","path"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,MAAMA,OAAN,CAAc;AACZ,SAAOC,MAAP,CAAcC,GAAd,EAAmBC,GAAnB,EAAwBC,IAAxB,EAA8B;AAC5B,UAAMC,cAAcC,WAAWH,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAED,QAAQ,GAAV,EAAeE,OAAOH,OAAtB,EAArB,CAA/B;AACA,UAAM;AACJI,eADI;AAEJC,cAFI;AAGJC,gBAHI;AAIJC,cAJI;AAKJC,iBALI;AAMJC,WANI;AAOJC,cAPI;AAQJC,qBARI;AASJC,aATI;AAUJC;AAVI,QAWFjB,IAAIkB,IAXR;;AAaA,UAAMC,iBAAiB,CAACX,SAAD,EAAYC,QAAZ,EAAsBG,WAAtB,EAAmCC,KAAnC,EAA0CC,QAA1C,EAAoDC,eAApD,CAAvB;AACA,UAAMK,gBAAgBD,eAAeE,GAAf,CAAmB,CAACC,KAAD,EAAQC,KAAR,KAAkB;AACzD,YAAMC,OAAO;AACX,WAAG,WADQ;AAEX,WAAG,UAFQ;AAGX,WAAG,aAHQ;AAIX,WAAG,OAJQ;AAKX,WAAG,UALQ;AAMX,WAAG;AANQ,OAAb;AAQA,aAAQF,UAAUG,SAAV,IAAuBH,UAAU,EAAlC,GAAwCE,KAAKD,KAAL,CAAxC,GAAsD,IAA7D;AACD,KAVqB,EAUnBG,MAVmB,CAUZJ,SAASA,UAAU,IAVP,EAUaK,IAVb,CAUkB,IAVlB,CAAtB;;AAYA,QAAI,CAACnB,SAAD,IAAc,CAACC,QAAf,IAA2B,CAACG,WAA5B,IAA2C,CAACC,KAA5C,IAAqD,CAACC,QAAtD,IAAkE,CAACC,eAAvE,EAAwF;AACtF,aAAOZ,YAAa,kDAAiDiB,aAAc,EAA5E,CAAP;AACD;;AAED,QAAI,CAACQ,oBAAUC,WAAV,CAAsBrB,SAAtB,CAAL,EAAuC,OAAOL,YAAY,kEAAZ,CAAP;AACvC,QAAI,CAACyB,oBAAUC,WAAV,CAAsBpB,QAAtB,CAAL,EAAsC,OAAON,YAAY,gEAAZ,CAAP;AACtC,QAAIyB,oBAAUE,mBAAV,CAA8BjB,KAA9B,EAAqCN,KAAzC,EAAgD,OAAOJ,YAAYyB,oBAAUE,mBAAV,CAA8BjB,KAA9B,EAAqCT,OAAjD,CAAP;AAChD,QAAI,CAACwB,oBAAUG,mBAAV,CAA8BjB,QAA9B,EAAwCC,eAAxC,CAAL,EAA+D,OAAOZ,YAAY,gCAAZ,CAAP;AAC/D,QAAIyB,oBAAUI,kBAAV,CAA6BlB,QAA7B,CAAJ,EAA4C,OAAOX,YAAY,kEAAZ,CAAP;;AAE5CH,QAAIQ,SAAJ,GAAgBA,UAAUyB,QAAV,GAAqBC,IAArB,EAAhB;AACAlC,QAAIS,QAAJ,GAAeA,SAASwB,QAAT,GAAoBC,IAApB,EAAf;AACAlC,QAAIU,UAAJ,GAAiBA,cAAc,IAA/B;AACAV,QAAIW,QAAJ,GAAeA,YAAY,IAA3B;AACAX,QAAIY,WAAJ,GAAkBA,YAAYqB,QAAZ,GAAuBC,IAAvB,EAAlB;AACAlC,QAAIa,KAAJ,GAAYA,MAAMoB,QAAN,GAAiBC,IAAjB,EAAZ;AACAlC,QAAIc,QAAJ,GAAeA,SAASmB,QAAT,GAAoBC,IAApB,EAAf;AACAlC,QAAIiB,WAAJ,GAAkBA,YAAYgB,QAAZ,GAAuBC,IAAvB,EAAlB;AACAlC,QAAIgB,OAAJ,GAAchB,IAAImC,IAAJ,GAAUnC,IAAImC,IAAJ,CAASC,IAAnB,GAA0B,IAAxC;;AAGA,WAAOlC,MAAP;AACD,GAnDW,CAmDV;AAnDU,C,CAoDZ;;kBAEaJ,O","file":"inspector.js","sourceRoot":"/home/enejakc/Documents/projects/ireporter-db-practice/server/middleware","sourcesContent":["import Validator from '../validators/validator';\nimport pool from '../db/config';\n\nclass Inspect {\n  static signup(req, res, next) {\n    const response400 = message => res.status(400).json({ status: 400, error: message });\n    const {\n      firstname,\n      lastname,\n      othernames,\n      username,\n      phoneNumber,\n      email,\n      password,\n      confirmPassword,\n      picture,\n      adminSecret,\n    } = req.body;\n\n    const requiredFields = [firstname, lastname, phoneNumber, email, password, confirmPassword];\n    const missingFields = requiredFields.map((field, index) => {\n      const keys = {\n        0: 'firstname',\n        1: 'lastname',\n        2: 'phoneNumber',\n        3: 'email',\n        4: 'password',\n        5: 'confirmPassword',\n      };\n      return (field === undefined || field === '') ? keys[index] : null;\n    }).filter(field => field !== null).join(', ');\n\n    if (!firstname || !lastname || !phoneNumber || !email || !password || !confirmPassword) {\n      return response400(`values are required form the following fields: ${missingFields}`);\n    }\n\n    if (!Validator.isValidName(firstname)) return response400('invalid first name. First name must be a minimum of 2 characters');\n    if (!Validator.isValidName(lastname)) return response400('invalid last name. Last name must be a minimum of 2 characters');\n    if (Validator.customValidateEmail(email).error) return response400(Validator.customValidateEmail(email).message);\n    if (!Validator.isMatchingPasswords(password, confirmPassword)) return response400('the two passwords do not match');\n    if (Validator.isPasswordTooShort(password)) return response400('Invalid password. Password should have a minimum of 6 characters');\n\n    req.firstname = firstname.toString().trim();\n    req.lastname = lastname.toString().trim();\n    req.othernames = othernames || null;\n    req.username = username || null;\n    req.phoneNumber = phoneNumber.toString().trim();\n    req.email = email.toString().trim();\n    req.password = password.toString().trim();\n    req.adminSecret = adminSecret.toString().trim();\n    req.picture = req.file? req.file.path : null;\n\n\n    return next();\n  } // END signup\n} // END Inspect\n\nexport default Inspect;\n"]}